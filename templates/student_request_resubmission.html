{% extends 'base_dashboard.html' %}
{% block title %}Request Resubmission{% endblock %}
{% block breadcrumb %}Examinations > My Submissions > Request Resubmission{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/useredit.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/student_resubmission.css') }}">

<script>
  document.addEventListener("DOMContentLoaded", function () {
    setTimeout(() => {
      document.querySelectorAll(".error").forEach(el => {
        el.style.transition = "opacity 0.5s ease-out";
        el.style.opacity = "0";
        setTimeout(() => el.remove(), 500);
      });
    }, 5000);
  });
</script>

<h2 style="margin-left: 20px;">Request Resubmission</h2><hr>

<form method="POST" class="form-container" enctype="multipart/form-data">
  <label>Student ID:</label>
  <input type="text" name="student_id" value="{{ student.user_id }}" readonly>

  <label>Student Name:</label>
  <input type="text" name="student_name" value="{{ student.name }}" readonly>

  <label>Student Course:</label>
  <input type="text" name="student_course" value="{{ course_name }}" readonly>

  <label>Assessment Code:</label>
  <input type="text" name="assessment_code" value="{{ submission.assessment_code }}" readonly>

  <label>Submitted File:</label>
  <input type="text" name="old_file" value="{{ submission.filename }}" readonly>

  <label>Submitted At:</label>
  <input type="text" name="submitted_at" value="{{ submission.submitted_at.strftime('%Y-%m-%d %H:%M:%S') }}" readonly>

  <label>Reason for Resubmission:</label>
  <textarea name="reason" rows="4" required placeholder="Explain why you need to resubmit..."></textarea>

  <label>Upload New File:</label>
  <input type="file" name="new_file" required>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
      {% if category == 'error' %}
        <div class="error">{{ message }}</div>
      {% endif %}
    {% endfor %}
  {% endwith %}

  <div class="form-actions">
    <a href="{{ url_for('student_submissions') }}" class="btn-reset">Cancel</a>
    <button type="submit" class="btn-save">Submit Request</button>
  </div>
</form>
{% endblock %}
